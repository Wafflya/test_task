# Документация по API
## Только для администраторов

#### Создание опроса
##### POST /create_poll
   **Формат запроса:**

```
{
    	"title": <Строка: Название опроса>,
        "start_date": <Дата начала: ГГГГ-ММ-ДД>,
        "end_date": <Дата конца: ГГГГ-ММ-ДД>,
        "description": <Строка: Описание опроса>
}
```
   
   *Все атрибуты обязательны*
    
    
#### Редактирование опроса
##### PUT /edit_poll/*id опроса*
   **Формат запроса:**
    
```
{
    "title": <Строка: Название>,
    "end_date": <Дата конца: ГГГГ-ММ-ДД>,
    "description": <Строка: Описание опроса>
}

```
*Можно указать любое количество и комбинации вышеперечисленных полей*

#### Удаление опроса
##### DELETE /delete_poll/*id опроса*

*Дополнительные параметры не требуются*


#### Создание вопроса
##### POST /create_question
   **Формат запроса:**
```
{
        "poll": <Число: Айди>, # id Опроса, в котором будет данный вопрос
        "text": "<Строка:Текст>",  #  Текст вопроса
        "type": "<Строка:Тип>"  #  Тип вопроса, MP - возможно несколько вариантов, OP - Один вариант из предложенных, TX - Ответ текстом
        "options":[<Строка:Текст опции>, <Строка:Текст опции>, ]  # Для типов OP и MP варианты ответа

}
```
*Параметры poll,text,type являются обязательными для всех типов. Если type:"MP" или "OP", "options" также обязателен.*
#### Редактирование вопроса
##### PUT /edit_question/*id вопроса*   # Можно посмотреть айди интересующего вопроса здесь GET /all_questions/
   
   **Формат запроса: **
```
{
        "poll": <Число: Айди>, # id Опроса, в котором будет данный вопрос
        "text": "<Строка:Текст>",  #  Текст вопроса
        "type": "<Строка:Тип>"  #  Тип вопроса, MP - возможно несколько вариантов, OP - Один вариант из предложенных, TX - Ответ текстом
        "options":[<Строка:Текст опции>, <Строка:Текст опции>, ]  # Для типов OP и MP варианты ответа. Перезапишутся

}
```

#### Удаление вопроса
##### DELETE /edit_question/*id вопроса*


## Для всех пользователей

#### Получение списка активных опросов
##### GET /active_polls/

   **Формат ответа:**


```
[
    {
        "id": <Число: Айди>,
        "title": <Строка: Название>,
        "start_date": <Дата начала: ГГГГ-ММ-ДД>,
        "end_date": <Дата конца: ГГГГ-ММ-ДД>,
        "description": <Строка: Описание>
    },
    {
        ...
    }
]
```

#### Прохождение опроса

##### GET /poll_detail/*id* 
###### Возвращает данные опроса по id

   **Формат ответа:**

 
 ```
 {
    "title":  <Строка: Название опроса>,
    "description": <Строка: Описание опроса>,
    "questions_in_poll": [
        {
            "id": <Число: Айди вопроса>,
            "text": <Строка: Текст вопроса>,
            "type": <Тип>, # MP - возможно несколько вариантов, OP - Один вариант из предложенных, TX - Ответ текстом
            "options": [     # Варианты, если вопрос с выбором
                {
                    "id": <Число: Айди варианта>,
                    "text": <Строка: Текст варианта>,
                },
                {
                    "id": <Число: Айди варианта>,
                    "text": <Строка: Текст варианта>,
                },
                {
                  ...
                }
            ]
        },
        {
           ...
        }
    ],
    "start_date": <Дата начала: ГГГГ-ММ-ДД>,
    "end_date": <Дата конца: ГГГГ-ММ-ДД>
}
 ```
 
##### POST /poll_detail/*id*  
###### Отправление данных проголосовавшего пользователя

* Формат отправки данных:

    * Если пользователь залогинен
        ```
        {
        "<id вопроса>":<Число:Вариант>, # Если вопрос типа MP|OP
        "<id вопроса>":<Строка:Ответ>, # Если вопрос типа TX
            ...
        }
        ```

    * Если пользователь проходит анонимно и имеет в качестве идентификатора числовой ID
        ```
        {
        'anon_user_id':<Число: числовой ID пользователя>
        "<id вопроса>":<Число:Вариант>, # Если вопрос типа MP|OP
        "<id вопроса>":<Строка:Ответ>, # Если вопрос типа TX
            ...
        }
        ```
  *На некоторые вопросы можно не отвечать, тогда в графе ответ будет выводиться "Нет ответа"*

#### Получение пройденных пользователем опросов с детализацией по ответам
* Если пользователь залогинен
    **GET /my_answers**  
* Если пользователь участвовал анонимно
    **GET /anonym_answers/`<Число: числовой ID пользователя>`**
    
 ##### Формат ответа
 ```
 [
    {
        "title":  <Строка: Название опроса>,
        "description": <Строка: Описание опроса>,
        "questions_in_poll": [
            {
                "1. <Строка: Текст вопроса>": "<Вариант 1>, <Вариант 2>",  # Если вопрос типа MP
                "2. <Строка: Текст вопроса>": "<Вариант 1>",  # Если вопрос типа OP
                "3. <Строка: Текст вопроса>": "<Строка:Ответ>", # Если вопрос типа TX
                ...
            }
        ],
        "start_date": <Дата начала: ГГГГ-ММ-ДД>,
        "end_date": <Дата конца: ГГГГ-ММ-ДД>,
    },
]
```
